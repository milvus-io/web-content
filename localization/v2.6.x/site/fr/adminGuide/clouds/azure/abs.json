{"codeList":["export RESOURCE_GROUP=\"<your resource group>\"\nexport AKS_CLUSTER=\"<your aks cluster name>\" \nexport SUB_ID=\"<your Subscription ID>\"\nexport USER_ASSIGNED_IDENTITY_NAME=\"workload-identity\"\nexport SERVICE_ACCOUNT_NAME=\"milvus-abs-access-sa\"\nexport STORAGE_ACCOUNT_NAME=\"milvustesting1\"\nexport CONTAINER_NAME=\"testmilvus\"\nexport LOCATION=\"<your location>\"\nexport SERVICE_ACCOUNT_NAMESPACE=\"default\"\n","az aks update -g ${RESOURCE_GROUP} -n ${AKS_CLUSTER} --enable-oidc-issuer --enable-workload-identity\n","export SERVICE_ACCOUNT_ISSUER=\"$(az aks show --resource-group ${RESOURCE_GROUP} --name ${AKS_CLUSTER} --query 'oidcIssuerProfile.issuerUrl' -otsv)\"\n","az storage account create -n ${STORAGE_ACCOUNT_NAME} -g ${RESOURCE_GROUP} -l $LOCATION --sku Standard_LRS --min-tls-version TLS1_2\naz storage container create -n ${CONTAINER_NAME} --account-name ${STORAGE_ACCOUNT_NAME}\n\n","az identity create --name \"${USER_ASSIGNED_IDENTITY_NAME}\" --resource-group \"${RESOURCE_GROUP}\"\nexport USER_ASSIGNED_IDENTITY_CLIENT_ID=\"$(az identity show --name \"${USER_ASSIGNED_IDENTITY_NAME}\" --resource-group \"${RESOURCE_GROUP}\" --query 'clientId' -otsv)\"\nexport USER_ASSIGNED_IDENTITY_OBJECT_ID=\"$(az identity show --name \"${USER_ASSIGNED_IDENTITY_NAME}\" --resource-group \"${RESOURCE_GROUP}\" --query 'principalId' -otsv)\"\naz role assignment create --role \"Storage Blob Data Contributor\" --assignee \"${USER_ASSIGNED_IDENTITY_OBJECT_ID}\" --scope \"/subscriptions/${SUB_ID}/resourceGroups/${RESOURCE_GROUP}/providers/Microsoft.Storage/storageAccounts/${STORAGE_ACCOUNT_NAME}\"\n\n","cat <<EOF | kubectl apply -f -\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  annotations:\n    azure.workload.identity/client-id: ${USER_ASSIGNED_IDENTITY_CLIENT_ID}\n  name: ${SERVICE_ACCOUNT_NAME}\nEOF\n","az identity federated-credential create \\\n  --name \"kubernetes-federated-credential\" \\\n  --identity-name \"${USER_ASSIGNED_IDENTITY_NAME}\" \\\n  --resource-group \"${RESOURCE_GROUP}\" \\\n  --issuer \"${SERVICE_ACCOUNT_ISSUER}\" \\\n  --subject \"system:serviceaccount:${SERVICE_ACCOUNT_NAMESPACE}:${SERVICE_ACCOUNT_NAME}\"\n","helm install -f values.yaml my-release milvus/milvus\n","cluster:\n  enabled: true\n\nservice:\n  type: LoadBalancer\n\nextraConfigFiles:\n  user.yaml: |+\n    common:\n      storageType: remote\n\nminio:\n  enabled: false\n\nlabels:\n  azure.workload.identity/use: \"true\"\n\nserviceAccount:\n  create: false\n  name: milvus-abs-access-sa # SERVICE_ACCOUNT_NAME\n\nexternalS3:\n  enabled: true\n  host: core.windows.net\n  port: 443\n  rootPath: my-release\n  bucketName: testmilvus # CONTAINER_NAME\n  cloudProvider: azure\n  useSSL: true\n  useIAM: true\n  accessKey: \"milvustesting1\" # STORAGE_ACCOUNT_NAME\n  secretKey: \"\"\n"],"headingContent":"Configure Blob Storage Access by Workload Identity","anchorList":[{"label":"Configure Blob Storage Access by Workload Identity","href":"Configure-Blob-Storage-Access-by-Workload-Identity","type":1,"isActive":false},{"label":"Configure applications to use Workload Identity","href":"Configure-applications-to-use-Workload-Identity","type":2,"isActive":false},{"label":"Deploy Milvus","href":"Deploy-Milvus","type":2,"isActive":false}]}