{"codeList":["helm repo add grafana https://grafana.github.io/helm-charts\nhelm repo update\n","loki:\n  commonConfig:\n    replication_factor: 1\n  auth_enabled: false\n\nminio:\n  enabled: true\n","loki:\n  commonConfig:\n    replication_factor: 1\n  auth_enabled: false\n  storage:\n    bucketNames:\n      chunks: loki-chunks\n      ruler: loki-ruler\n      admin: loki-admin\n    type: 's3'\n    s3:\n      endpoint: s3.us-west-2.amazonaws.com\n      region: us-west-2\n      secretAccessKey: <accessKey>\n      accessKeyId: <keyId>\n","kubectl create ns loki\nhelm install --values loki.yaml loki grafana/loki -n loki\n","alloy:\n  enableReporting: false\n  resources: {}\n  configMap:\n    create: true\n    content: |-\n      loki.write \"remote_loki\" {\n        endpoint {\n          url       = \"http://loki-gateway/loki/api/v1/push\"\n        }\n      }\n      \n      loki.source.file \"milvus_logs\" {\n        targets = local.file_match.milvus_log_files.targets\n        forward_to = [loki.write.remote_loki.receiver]\n      }\n      \n      local.file_match \"milvus_log_files\" {\n        path_targets = [\n          {\"__path__\" = \"/your/worker/node/var/log/pods/milvus_milvus-*/**/*.log\"},\n        ]\n      }\n  # mount to pods with host volume\n  mounts:\n    extra:\n      - name: log-pods\n        mountPath: /host/var/log/pods\n        readOnly: true\ncontroller:\n  type: 'daemonset'\n  # make volume that use host volume in worker node\n  volumes:\n    extra:\n      - name: log-pods\n        hostPath:\n          path: /var/log/pods\n","alloy:\n  enableReporting: false\n  resources: {}\n  configMap:\n    create: true\n    content: |-\n      loki.write \"remote_loki\" {\n        endpoint {\n          url       = \"http://loki-gateway/loki/api/v1/push\"\n        }\n      }\n\n      discovery.kubernetes \"milvus_pod\" {\n        role = \"pod\"\n      }\n\n      loki.source.kubernetes \"milvus_pod_logs\" {\n        targets = discovery.kubernetes.milvus_pod.output\n        forward_to = [loki.write.remote_loki.receiver]\n      }\n","helm install --values alloy.yaml alloy grafana/alloy -n loki\n","kubectl create ns monitoring\nhelm install my-grafana grafana/grafana --namespace monitoring\n","kubectl get secret --namespace monitoring my-grafana -o jsonpath=\"{.data.admin-password}\" | base64 --decode ; echo\n","export POD_NAME=$(kubectl get pods --namespace monitoring -l \"app.kubernetes.io/name=grafana,app.kubernetes.io/instance=my-grafana\" -o jsonpath=\"{.items[0].metadata.name}\")\nkubectl --namespace monitoring port-forward $POD_NAME 3000\n"],"headingContent":"Configure Grafana Loki","anchorList":[{"label":"Configure Grafana Loki","href":"Configure-Grafana-Loki","type":1,"isActive":false},{"label":"Introduction","href":"Introduction","type":1,"isActive":false},{"label":"1. Using host volumes of kubernetes worker node","href":"1-Using-host-volumes-of-kubernetes-worker-node","type":2,"isActive":false},{"label":"2. Using kubernetes API server","href":"2-Using-kubernetes-API-server","type":2,"isActive":false},{"label":"Prerequisites","href":"Prerequisites","type":2,"isActive":false},{"label":"Deploy Loki","href":"Deploy-Loki","type":2,"isActive":false},{"label":"1. Add Grafana's Helm Chart Repository","href":"1-Add-Grafanas-Helm-Chart-Repository","type":3,"isActive":false},{"label":"2. Configure Object Storage for Loki","href":"2-Configure-Object-Storage-for-Loki","type":3,"isActive":false},{"label":"3. Install Loki","href":"3-Install-Loki","type":3,"isActive":false},{"label":"Deploy Alloy","href":"Deploy-Alloy","type":2,"isActive":false},{"label":"Create Alloy Configuration","href":"Create-Alloy-Configuration","type":3,"isActive":false},{"label":"Install Alloy","href":"Install-Alloy","type":3,"isActive":false},{"label":"Query Logs with Grafana","href":"Query-Logs-with-Grafana","type":2,"isActive":false},{"label":"1. Deploy Grafana","href":"1-Deploy-Grafana","type":3,"isActive":false},{"label":"2. Add Loki as a Data Source in Grafana","href":"2-Add-Loki-as-a-Data-Source-in-Grafana","type":3,"isActive":false},{"label":"3. Query Milvus Logs","href":"3-Query-Milvus-Logs","type":3,"isActive":false}]}