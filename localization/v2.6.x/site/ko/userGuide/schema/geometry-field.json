{"codeList":["from pymilvus import MilvusClient, DataType\nimport numpy as np\n\ndim = 8\ncollection_name = \"geo_collection\"\nmilvus_client = MilvusClient(\"http://localhost:19530\")\n\n# Create schema with a GEOMETRY field\nschema = milvus_client.create_schema(enable_dynamic_field=True)\nschema.add_field(\"id\", DataType.INT64, is_primary=True)\nschema.add_field(\"embeddings\", DataType.FLOAT_VECTOR, dim=dim)\n# highlight-next-line\nschema.add_field(\"geo\", DataType.GEOMETRY, nullable=True)\nschema.add_field(\"name\", DataType.VARCHAR, max_length=128)\n\nmilvus_client.create_collection(collection_name, schema=schema, consistency_level=\"Strong\")\n","// java\n","// nodejs\n","// go\n","# restful\n","rng = np.random.default_rng(seed=19530)\ngeo_points = [\n    'POINT(13.399710 52.518010)',\n    'POINT(13.403934 52.522877)',\n    'POINT(13.405088 52.521124)',\n    'POINT(13.408223 52.516876)',\n    'POINT(13.400092 52.521507)',\n    'POINT(13.408529 52.519274)',\n]\n\nrows = [\n    {\"id\": 1, \"name\": \"Shop A\", \"embeddings\": rng.random((1, dim))[0], \"geo\": geo_points[0]},\n    {\"id\": 2, \"name\": \"Shop B\", \"embeddings\": rng.random((1, dim))[0], \"geo\": geo_points[1]},\n    {\"id\": 3, \"name\": \"Shop C\", \"embeddings\": rng.random((1, dim))[0], \"geo\": geo_points[2]},\n    {\"id\": 4, \"name\": \"Shop D\", \"embeddings\": rng.random((1, dim))[0], \"geo\": geo_points[3]},\n    {\"id\": 5, \"name\": \"Shop E\", \"embeddings\": rng.random((1, dim))[0], \"geo\": geo_points[4]},\n    {\"id\": 6, \"name\": \"Shop F\", \"embeddings\": rng.random((1, dim))[0], \"geo\": geo_points[5]},\n]\n\ninsert_result = milvus_client.insert(collection_name, rows)\nprint(insert_result)\n\n# Expected output:\n# {'insert_count': 6, 'ids': [1, 2, 3, 4, 5, 6]}\n","// java\n","// nodejs\n","// go\n","# restful\n","index_params = milvus_client.prepare_index_params()\nindex_params.add_index(field_name=\"embeddings\", metric_type=\"L2\")\n\nmilvus_client.create_index(collection_name, index_params)\nmilvus_client.load_collection(collection_name)\n","// java\n","// nodejs\n","// go\n","# restful\n","top_left_lon, top_left_lat = 13.403683, 52.520711\nbottom_right_lon, bottom_right_lat = 13.455868, 52.495862\nbounding_box_wkt = f\"POLYGON(({top_left_lon} {top_left_lat}, {bottom_right_lon} {top_left_lat}, {bottom_right_lon} {bottom_right_lat}, {top_left_lon} {bottom_right_lat}, {top_left_lon} {top_left_lat}))\"\n\nquery_results = milvus_client.query(\n    collection_name,\n    # highlight-next-line\n    filter=f\"st_within(geo, '{bounding_box_wkt}')\",\n    output_fields=[\"name\", \"geo\"]\n)\nfor ret in query_results:\n    print(ret)\n    \n# Expected output:\n# {'name': 'Shop D', 'geo': 'POINT (13.408223 52.516876)', 'id': 4}\n# {'name': 'Shop F', 'geo': 'POINT (13.408529 52.519274)', 'id': 6}\n# {'name': 'Shop A', 'geo': 'POINT (13.39971 52.51801)', 'id': 1}\n# {'name': 'Shop B', 'geo': 'POINT (13.403934 52.522877)', 'id': 2}\n# {'name': 'Shop C', 'geo': 'POINT (13.405088 52.521124)', 'id': 3}\n# {'name': 'Shop D', 'geo': 'POINT (13.408223 52.516876)', 'id': 4}\n# {'name': 'Shop E', 'geo': 'POINT (13.400092 52.521507)', 'id': 5}\n# {'name': 'Shop F', 'geo': 'POINT (13.408529 52.519274)', 'id': 6}\n","// java\n","// nodejs\n","// go\n","# restful\n","center_point_lon, center_point_lat = 13.403683, 52.520711\nradius_meters = 1000.0\ncentral_point_wkt = f\"POINT({center_point_lon} {center_point_lat})\"\n\nquery_results = milvus_client.query(\n    collection_name,\n    # highlight-next-line\n    filter=f\"st_dwithin(geo, '{central_point_wkt}', {radius_meters})\",\n    output_fields=[\"name\", \"geo\"]\n)\nfor ret in query_results:\n    print(ret)\n    \n# Expected output:\n# hit: {'id': 4, 'distance': 0.9823770523071289, 'entity': {'name': 'Shop D', 'geo': 'POINT (13.408223 52.516876)'}}\n","// java\n","// nodejs\n","// go\n","# restful\n","vectors_to_search = rng.random((1, dim))\nresult = milvus_client.search(\n    collection_name,\n    vectors_to_search,\n    limit=3,\n    output_fields=[\"name\", \"geo\"],\n    # highlight-next-line\n    filter=f\"st_within(geo, '{bounding_box_wkt}')\"\n)\nfor hits in result:\n    for hit in hits:\n        print(f\"hit: {hit}\")\n        \n# Expected output:\n# hit: {'id': 6, 'distance': 1.3406795263290405, 'entity': {'name': 'Shop F', 'geo': 'POINT (13.408529 52.519274)'}}\n","// java\n","// nodejs\n","// go\n","# restful\n"],"headingContent":"Geometry Field","anchorList":[{"label":"기하학 필드Compatible with Milvus 2.6.4+","href":"Geometry-Field","type":1,"isActive":false},{"label":"지오메트리 필드란 무엇인가요?","href":"What-is-a-GEOMETRY-field","type":2,"isActive":false},{"label":"기본 작업","href":"Basic-operations","type":2,"isActive":false},{"label":"1단계: 기하학 필드 정의하기","href":"Step-1-Define-a-GEOMETRY-field","type":3,"isActive":false},{"label":"2단계: 데이터 삽입","href":"Step-2-Insert-data","type":3,"isActive":false},{"label":"3단계: 필터링 작업","href":"Step-3-Filtering-operations","type":3,"isActive":false},{"label":"다음: 쿼리 가속화","href":"Next-Accelerate-queries","type":2,"isActive":false},{"label":"FAQ","href":"FAQ","type":2,"isActive":false},{"label":"컬렉션에 동적 필드 기능을 활성화한 경우, 동적 필드 키에 기하 도형 데이터를 삽입할 수 있나요?","href":"If-Ive-enabled-the-dynamic-field-feature-for-my-collection-can-I-insert-geometric-data-into-a-dynamic-field-key","type":3,"isActive":false},{"label":"도형 필드가 mmap 기능을 지원하나요?","href":"Does-the-GEOMETRY-field-support-the-mmap-feature","type":3,"isActive":false},{"label":"GEOMETRY 필드를 null 가능으로 정의하거나 기본값을 설정할 수 있나요?","href":"Can-I-define-the-GEOMETRY-field-as-nullable-or-set-a-default-value","type":3,"isActive":false}]}