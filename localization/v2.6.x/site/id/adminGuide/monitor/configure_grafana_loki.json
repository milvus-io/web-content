{"codeList":["helm repo add grafana https://grafana.github.io/helm-charts\nhelm repo update\n","loki:\n  commonConfig:\n    replication_factor: 1\n  auth_enabled: false\n\nminio:\n  enabled: true\n","loki:\n  commonConfig:\n    replication_factor: 1\n  auth_enabled: false\n  storage:\n    bucketNames:\n      chunks: loki-chunks\n      ruler: loki-ruler\n      admin: loki-admin\n    type: 's3'\n    s3:\n      endpoint: s3.us-west-2.amazonaws.com\n      region: us-west-2\n      secretAccessKey: <accessKey>\n      accessKeyId: <keyId>\n","kubectl create ns loki\nhelm install --values loki.yaml loki grafana/loki -n loki\n","alloy:\n  enableReporting: false\n  resources: {}\n  configMap:\n    create: true\n    content: |-\n      loki.write \"default\" {\n        endpoint {\n          url = \"http://loki-gateway/loki/api/v1/push\"\n        }\n      }\n\n      discovery.kubernetes \"pod\" {\n        role = \"pod\"\n      }\n\n      loki.source.kubernetes \"pod_logs\" {\n        targets    = discovery.relabel.pod_logs.output\n        forward_to = [loki.write.default.receiver]\n      }\n\n      // Rewrite the label set to make log query easier\n      discovery.relabel \"pod_logs\" {\n        targets = discovery.kubernetes.pod.targets\n        rule {\n          source_labels = [\"__meta_kubernetes_namespace\"]\n          action = \"replace\"\n          target_label = \"namespace\"\n        }\n\n        // \"pod\" <- \"__meta_kubernetes_pod_name\"\n        rule {\n          source_labels = [\"__meta_kubernetes_pod_name\"]\n          action = \"replace\"\n          target_label = \"pod\"\n        }\n\n        // \"container\" <- \"__meta_kubernetes_pod_container_name\"\n        rule {\n          source_labels = [\"__meta_kubernetes_pod_container_name\"]\n          action = \"replace\"\n          target_label = \"container\"\n        }\n\n        // \"app\" <- \"__meta_kubernetes_pod_label_app_kubernetes_io_name\"\n        rule {\n          source_labels = [\"__meta_kubernetes_pod_label_app_kubernetes_io_name\"]\n          action = \"replace\"\n          target_label = \"app\"\n        }\n\n        // \"job\" <- \"__meta_kubernetes_namespace\", \"__meta_kubernetes_pod_container_name\"\n        rule {\n          source_labels = [\"__meta_kubernetes_namespace\", \"__meta_kubernetes_pod_container_name\"]\n          action = \"replace\"\n          target_label = \"job\"\n          separator = \"/\"\n          replacement = \"$1\"\n        }\n\n        // L\"__path__\" <- \"__meta_kubernetes_pod_uid\", \"__meta_kubernetes_pod_container_name\"\n        rule {\n          source_labels = [\"__meta_kubernetes_pod_uid\", \"__meta_kubernetes_pod_container_name\"]\n          action = \"replace\"\n          target_label = \"__path__\"\n          separator = \"/\"\n          replacement = \"/var/log/pods/*$1/*.log\"\n        }\n\n        // \"container_runtime\" <- \"__meta_kubernetes_pod_container_id\"\n        rule {\n          source_labels = [\"__meta_kubernetes_pod_container_id\"]\n          action = \"replace\"\n          target_label = \"container_runtime\"\n          regex = \"^(\\\\S+):\\\\/\\\\/.+$\"\n          replacement = \"$1\"\n        }\n      }\n","helm install --values alloy.yaml alloy grafana/alloy -n loki\n","kubectl create ns monitoring\nhelm install my-grafana grafana/grafana --namespace monitoring\n","kubectl get secret --namespace monitoring my-grafana -o jsonpath=\"{.data.admin-password}\" | base64 --decode ; echo\n","export POD_NAME=$(kubectl get pods --namespace monitoring -l \"app.kubernetes.io/name=grafana,app.kubernetes.io/instance=my-grafana\" -o jsonpath=\"{.items[0].metadata.name}\")\nkubectl --namespace monitoring port-forward $POD_NAME 3000\n"],"headingContent":"Configure Grafana Loki","anchorList":[{"label":"Mengkonfigurasi Grafana Loki","href":"Configure-Grafana-Loki","type":1,"isActive":false},{"label":"Prasyarat","href":"Prerequisites","type":2,"isActive":false},{"label":"Menerapkan Loki","href":"Deploy-Loki","type":2,"isActive":false},{"label":"1. Menambahkan Repositori Bagan Helm Grafana","href":"1-Add-Grafanas-Helm-Chart-Repository","type":3,"isActive":false},{"label":"2. Mengonfigurasi Penyimpanan Objek untuk Loki","href":"2-Configure-Object-Storage-for-Loki","type":3,"isActive":false},{"label":"3. Menginstal Loki","href":"3-Install-Loki","type":3,"isActive":false},{"label":"Menyebarkan Paduan","href":"Deploy-Alloy","type":2,"isActive":false},{"label":"1. Membuat Konfigurasi Paduan","href":"1-Create-Alloy-Configuration","type":3,"isActive":false},{"label":"2. Instal Alloy","href":"2-Install-Alloy","type":3,"isActive":false},{"label":"Menanyakan Log dengan Grafana","href":"Query-Logs-with-Grafana","type":2,"isActive":false},{"label":"1. Menyebarkan Grafana","href":"1-Deploy-Grafana","type":3,"isActive":false},{"label":"2. Menambahkan Loki sebagai Sumber Data di Grafana","href":"2-Add-Loki-as-a-Data-Source-in-Grafana","type":3,"isActive":false},{"label":"3. Menanyakan Log Milvus","href":"3-Query-Milvus-Logs","type":3,"isActive":false}]}