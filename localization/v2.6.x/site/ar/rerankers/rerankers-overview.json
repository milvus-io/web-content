{"codeList":["pip install pymilvus[model]\n# or pip install \"pymilvus[model]\" for zsh.\n","from pymilvus.model.reranker import BGERerankFunction\n","bge_rf = BGERerankFunction(\n    model_name=\"BAAI/bge-reranker-v2-m3\",  # Specify the model name. Defaults to `BAAI/bge-reranker-v2-m3`.\n    device=\"cpu\" # Specify the device to use, e.g., 'cpu' or 'cuda:0'\n)\n","query = \"What event in 1956 marked the official birth of artificial intelligence as a discipline?\"\n\ndocuments = [\n    \"In 1950, Alan Turing published his seminal paper, 'Computing Machinery and Intelligence,' proposing the Turing Test as a criterion of intelligence, a foundational concept in the philosophy and development of artificial intelligence.\",\n    \"The Dartmouth Conference in 1956 is considered the birthplace of artificial intelligence as a field; here, John McCarthy and others coined the term 'artificial intelligence' and laid out its basic goals.\",\n    \"In 1951, British mathematician and computer scientist Alan Turing also developed the first program designed to play chess, demonstrating an early example of AI in game strategy.\",\n    \"The invention of the Logic Theorist by Allen Newell, Herbert A. Simon, and Cliff Shaw in 1955 marked the creation of the first true AI program, which was capable of solving logic problems, akin to proving mathematical theorems.\"\n]\n\nbge_rf(query, documents)\n","[RerankResult(text=\"The Dartmouth Conference in 1956 is considered the birthplace of artificial intelligence as a field; here, John McCarthy and others coined the term 'artificial intelligence' and laid out its basic goals.\", score=0.9911615761470803, index=1),\n RerankResult(text=\"In 1950, Alan Turing published his seminal paper, 'Computing Machinery and Intelligence,' proposing the Turing Test as a criterion of intelligence, a foundational concept in the philosophy and development of artificial intelligence.\", score=0.0326971950177779, index=0),\n RerankResult(text='The invention of the Logic Theorist by Allen Newell, Herbert A. Simon, and Cliff Shaw in 1955 marked the creation of the first true AI program, which was capable of solving logic problems, akin to proving mathematical theorems.', score=0.006514905766152258, index=3),\n RerankResult(text='In 1951, British mathematician and computer scientist Alan Turing also developed the first program designed to play chess, demonstrating an early example of AI in game strategy.', score=0.0042116724917325935, index=2)]\n","entities = [\n    {'doc_id': 0, 'doc_vector': [-0.0372721,0.0101959,...,-0.114994], 'doc_text': \"In 1950, Alan Turing published his seminal paper, 'Computing Machinery and Intelligence,' proposing the Turing Test as a criterion of intelligence, a foundational concept in the philosophy and development of artificial intelligence.\"}, \n    {'doc_id': 1, 'doc_vector': [-0.00308882,-0.0219905,...,-0.00795811], 'doc_text': \"The Dartmouth Conference in 1956 is considered the birthplace of artificial intelligence as a field; here, John McCarthy and others coined the term 'artificial intelligence' and laid out its basic goals.\"}, \n    {'doc_id': 2, 'doc_vector': [0.00945078,0.00397605,...,-0.0286199], 'doc_text': 'In 1951, British mathematician and computer scientist Alan Turing also developed the first program designed to play chess, demonstrating an early example of AI in game strategy.'}, \n    {'doc_id': 3, 'doc_vector': [-0.0391119,-0.00880096,...,-0.0109257], 'doc_text': 'The invention of the Logic Theorist by Allen Newell, Herbert A. Simon, and Cliff Shaw in 1955 marked the creation of the first true AI program, which was capable of solving logic problems, akin to proving mathematical theorems.'}\n]\n","from pymilvus import MilvusClient, DataType\n\nclient = MilvusClient(\n    uri=\"http://10.102.6.214:19530\" # replace with your own Milvus server address\n)\n\nclient.drop_collection('test_collection')\n\n# define schema\n\nschema = client.create_schema(auto_id=False, enabel_dynamic_field=True)\n\nschema.add_field(field_name=\"doc_id\", datatype=DataType.INT64, is_primary=True, description=\"document id\")\nschema.add_field(field_name=\"doc_vector\", datatype=DataType.FLOAT_VECTOR, dim=384, description=\"document vector\")\nschema.add_field(field_name=\"doc_text\", datatype=DataType.VARCHAR, max_length=65535, description=\"document text\")\n\n# define index params\n\nindex_params = client.prepare_index_params()\n\nindex_params.add_index(field_name=\"doc_vector\", index_type=\"IVF_FLAT\", metric_type=\"IP\", params={\"nlist\": 128})\n\n# create collection\n\nclient.create_collection(collection_name=\"test_collection\", schema=schema, index_params=index_params)\n\n# insert data into collection\n\nclient.insert(collection_name=\"test_collection\", data=entities)\n\n# Output:\n# {'insert_count': 4, 'ids': [0, 1, 2, 3]}\n","# search results based on our query\n\nres = client.search(\n    collection_name=\"test_collection\",\n    data=[[-0.045217834, 0.035171617, ..., -0.025117004]], # replace with your query vector\n    limit=3,\n    output_fields=[\"doc_id\", \"doc_text\"]\n)\n\nfor i in res[0]:\n    print(f'distance: {i[\"distance\"]}')\n    print(f'doc_text: {i[\"entity\"][\"doc_text\"]}')\n","distance: 0.7235960960388184\ndoc_text: The Dartmouth Conference in 1956 is considered the birthplace of artificial intelligence as a field; here, John McCarthy and others coined the term 'artificial intelligence' and laid out its basic goals.\ndistance: 0.6269873976707458\ndoc_text: In 1950, Alan Turing published his seminal paper, 'Computing Machinery and Intelligence,' proposing the Turing Test as a criterion of intelligence, a foundational concept in the philosophy and development of artificial intelligence.\ndistance: 0.5340118408203125\ndoc_text: The invention of the Logic Theorist by Allen Newell, Herbert A. Simon, and Cliff Shaw in 1955 marked the creation of the first true AI program, which was capable of solving logic problems, akin to proving mathematical theorems.\n","# use reranker to rerank search results\n\nfrom pymilvus.model.reranker import CrossEncoderRerankFunction\n\nce_rf = CrossEncoderRerankFunction(\n    model_name=\"cross-encoder/ms-marco-MiniLM-L-6-v2\",  # Specify the model name.\n    device=\"cpu\" # Specify the device to use, e.g., 'cpu' or 'cuda:0'\n)\n\nreranked_results = ce_rf(\n    query='What event in 1956 marked the official birth of artificial intelligence as a discipline?',\n    documents=[\n        \"In 1950, Alan Turing published his seminal paper, 'Computing Machinery and Intelligence,' proposing the Turing Test as a criterion of intelligence, a foundational concept in the philosophy and development of artificial intelligence.\",\n        \"The Dartmouth Conference in 1956 is considered the birthplace of artificial intelligence as a field; here, John McCarthy and others coined the term 'artificial intelligence' and laid out its basic goals.\",\n        \"In 1951, British mathematician and computer scientist Alan Turing also developed the first program designed to play chess, demonstrating an early example of AI in game strategy.\",\n        \"The invention of the Logic Theorist by Allen Newell, Herbert A. Simon, and Cliff Shaw in 1955 marked the creation of the first true AI program, which was capable of solving logic problems, akin to proving mathematical theorems.\"\n    ],\n    top_k=3\n)\n\n# print the reranked results\nfor result in reranked_results:\n    print(f'score: {result.score}')\n    print(f'doc_text: {result.text}')\n","score: 6.250532627105713\ndoc_text: The Dartmouth Conference in 1956 is considered the birthplace of artificial intelligence as a field; here, John McCarthy and others coined the term 'artificial intelligence' and laid out its basic goals.\nscore: -2.9546022415161133\ndoc_text: In 1950, Alan Turing published his seminal paper, 'Computing Machinery and Intelligence,' proposing the Turing Test as a criterion of intelligence, a foundational concept in the philosophy and development of artificial intelligence.\nscore: -4.771512031555176\ndoc_text: The invention of the Logic Theorist by Allen Newell, Herbert A. Simon, and Cliff Shaw in 1955 marked the creation of the first true AI program, which was capable of solving logic problems, akin to proving mathematical theorems.\n"],"headingContent":"Rerankers Overview","anchorList":[{"label":"Rerankers Overview","href":"Rerankers-Overview","type":1,"isActive":false},{"label":"Example 1: Use BGE rerank function to rerank documents according to a query","href":"Example-1-Use-BGE-rerank-function-to-rerank-documents-according-to-a-query","type":2,"isActive":false},{"label":"Example 2: Use a reranker to enhance relevance of search results","href":"Example-2-Use-a-reranker-to-enhance-relevance-of-search-results","type":2,"isActive":false}]}