---
id: woodpecker_architecture.md
title: نقار الخشب
summary: >-
  Woodpecker هو نظام WAL سحابي أصلي في Milvus 2.6. مع بنية خالية من الأقراص
  ووضعين للنشر، فإنه يوفر إنتاجية عالية، ونفقات تشغيلية منخفضة، وقابلية توسع
  سلسة على تخزين الكائنات.
---
<h1 id="Woodpecker" class="common-anchor-header">نقار الخشب<button data-href="#Woodpecker" class="anchor-icon" translate="no">
      <svg translate="no"
        aria-hidden="true"
        focusable="false"
        height="20"
        version="1.1"
        viewBox="0 0 16 16"
        width="16"
      >
        <path
          fill="#0092E4"
          fill-rule="evenodd"
          d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"
        ></path>
      </svg>
    </button></h1><p>في الإصدار 2.6 من Milvus 2.6، يستبدل Woodpecker نظام Woodpecker نظام سجل الكتابة المسبق (WAL) المصمم خصيصًا للسحابة. تم تصميم Woodpecker لتخزين الكائنات، وهو يعمل على تبسيط العمليات وزيادة الإنتاجية وتوسيع نطاقها دون عناء.</p>
<p>أهداف تصميم Woodpecker:</p>
<ul>
<li><p>أعلى إنتاجية في البيئات السحابية</p></li>
<li><p>تسجيل دائم ومُلحق فقط من أجل استرداد موثوق به</p></li>
<li><p>الحد الأدنى من النفقات التشغيلية بدون أقراص محلية أو وسطاء خارجيين</p></li>
</ul>
<h2 id="Zero-disk-architecture" class="common-anchor-header">بنية خالية من الأقراص<button data-href="#Zero-disk-architecture" class="anchor-icon" translate="no">
      <svg translate="no"
        aria-hidden="true"
        focusable="false"
        height="20"
        version="1.1"
        viewBox="0 0 16 16"
        width="16"
      >
        <path
          fill="#0092E4"
          fill-rule="evenodd"
          d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"
        ></path>
      </svg>
    </button></h2><p>إن الابتكار الأساسي في Woodpecker هو بنيته الخالية من الأقراص:</p>
<ul>
<li>جميع بيانات السجل المخزنة في تخزين الكائنات السحابية (مثل Amazon S3 أو Google Cloud Storage أو Alibaba OS)</li>
<li>البيانات الوصفية المُدارة من خلال مخازن القيمة الرئيسية الموزعة مثل <strong>etcd</strong></li>
<li>لا توجد تبعيات أقراص محلية للعمليات الأساسية</li>
</ul>
<p>
  
   <span class="img-wrapper"> <img translate="no" src="/docs/v2.6.x/assets/woodpecker_layers.png" alt="woodpecker layers" class="doc-image" id="woodpecker-layers" />
   </span> <span class="img-wrapper"> <span>طبقات نقار الخشب</span> </span></p>
<h2 id="Architecture-components" class="common-anchor-header">مكونات البنية<button data-href="#Architecture-components" class="anchor-icon" translate="no">
      <svg translate="no"
        aria-hidden="true"
        focusable="false"
        height="20"
        version="1.1"
        viewBox="0 0 16 16"
        width="16"
      >
        <path
          fill="#0092E4"
          fill-rule="evenodd"
          d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"
        ></path>
      </svg>
    </button></h2><p>يتضمن النشر القياسي لنقار الخشب المكونات التالية:</p>
<ul>
<li><strong>العميل</strong>: طبقة واجهة لإصدار طلبات القراءة والكتابة</li>
<li><strong>مخزن السجل</strong>: يدير التخزين المؤقت للكتابة بسرعة عالية، والتحميل غير المتزامن إلى التخزين، وضغط السجل</li>
<li><strong>واجهة التخزين الخلفية</strong>: يدعم خدمات تخزين قابلة للتطوير ومنخفضة التكلفة مثل S3 و GCS وأنظمة الملفات مثل EFS</li>
<li><strong>إلخ</strong>: تخزين البيانات الوصفية وتنسيق حالة السجل عبر العقد الموزعة</li>
</ul>
<h2 id="Deployment-modes" class="common-anchor-header">أوضاع النشر<button data-href="#Deployment-modes" class="anchor-icon" translate="no">
      <svg translate="no"
        aria-hidden="true"
        focusable="false"
        height="20"
        version="1.1"
        viewBox="0 0 16 16"
        width="16"
      >
        <path
          fill="#0092E4"
          fill-rule="evenodd"
          d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"
        ></path>
      </svg>
    </button></h2><p>يوفر Woodpecker وضعين للنشر ليتناسب مع احتياجاتك الخاصة:</p>
<h3 id="MemoryBuffer---Lightweight-and-maintenance-free" class="common-anchor-header">MemoryBuffer - خفيف الوزن وخالي من الصيانة</h3><p>يوفّر وضع MemoryBuffer خيار نشر بسيط وخفيف الوزن حيث يقوم عميل Woodpecker المضمّن بتخزين الكتابات الواردة مؤقتًا في الذاكرة ويقوم بمسحها بشكل دوري إلى خدمة تخزين الكائنات السحابية. في هذا الوضع، يتم تضمين المخزن المؤقت للذاكرة مباشرةً في العميل، مما يتيح التجميع الفعال قبل المسح إلى S3. تتم إدارة البيانات الوصفية باستخدام <strong>etcd</strong> لضمان الاتساق والتنسيق. هذا الوضع هو الأنسب لأحمال العمل ذات الدُفعات الثقيلة في عمليات النشر على نطاق أصغر أو بيئات الإنتاج التي تعطي الأولوية للبساطة على الأداء، خاصةً عندما لا يكون زمن انتقال الكتابة المنخفض أمرًا بالغ الأهمية. يتراوح زمن انتقال الكتابة في هذا الوضع بشكل عام بين 200-500 مللي ثانية.</p>
<p>
  
   <span class="img-wrapper"> <img translate="no" src="/docs/v2.6.x/assets/woodpecker_memorybuffer_mode_deployment.png" alt="woodpecker memory mode deployment" class="doc-image" id="woodpecker-memory-mode-deployment" />
   </span> <span class="img-wrapper"> <span>نشر وضع ذاكرة نقار الخشب</span> </span></p>
<h3 id="QuorumBuffer---Optimized-for-low-latency-high-durability" class="common-anchor-header">QuorumBuffer - مُحسَّن لزمن انتقال منخفض ومتانة عالية</h3><p>تم تصميم وضع QuorumBuffer لأحمال عمل القراءة/الكتابة الحساسة لوقت الاستجابة وذات التردد العالي والتي تتطلب استجابة في الوقت الحقيقي وتحملاً قوياً للأخطاء. في هذا الوضع، يتفاعل عميل Woodpecker مع نظام نصاب ثلاثي النسخ لتوفير تخزين مؤقت عالي السرعة للكتابة وضمان اتساق قوي وتوافر عالٍ من خلال الإجماع الموزع.</p>
<p>تُعتبر الكتابة ناجحة بمجرد نجاح العميل في نسخ البيانات بنجاح إلى اثنتين على الأقل من عُقد النصاب الثلاثة، وعادةً ما تكتمل الكتابة في غضون جزء من الثانية من خانة واحدة، وبعد ذلك يتم مسح البيانات بشكل غير متزامن إلى تخزين الكائنات السحابية لضمان المتانة على المدى الطويل. تقلل هذه البنية من الحالة على العقدة، وتلغي الحاجة إلى وحدات تخزين الأقراص المحلية الكبيرة، وتتجنب الإصلاحات المعقدة المضادة للإنتروبيا التي غالباً ما تكون مطلوبة في الأنظمة التقليدية القائمة على النصاب.</p>
<p>والنتيجة هي طبقة WAL مبسطة وقوية ومثالية لبيئات الإنتاج ذات المهام الحرجة حيث يكون الاتساق والتوافر والاسترداد السريع ضرورياً.</p>
<p>
  
   <span class="img-wrapper"> <img translate="no" src="/docs/v2.6.x/assets/woodpecker_quorumbuffer_mode_deployment.png" alt="woodpecker quorum mode deployment" class="doc-image" id="woodpecker-quorum-mode-deployment" />
   </span> <span class="img-wrapper"> <span>نشر وضع نصاب نقار الخشب</span> </span></p>
<h2 id="Performance-benchmarks" class="common-anchor-header">معايير الأداء<button data-href="#Performance-benchmarks" class="anchor-icon" translate="no">
      <svg translate="no"
        aria-hidden="true"
        focusable="false"
        height="20"
        version="1.1"
        viewBox="0 0 16 16"
        width="16"
      >
        <path
          fill="#0092E4"
          fill-rule="evenodd"
          d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"
        ></path>
      </svg>
    </button></h2><p>أجرينا اختبارات معيارية شاملة لتقييم أداء Woodpecker في إعداد أحادي العقدة وعميل واحد وتدفق سجل واحد. كانت النتائج مبهرة عند مقارنتها مع Kafka وPulsar:</p>
<table>
<thead>
<tr><th>النظام</th><th>كافكا</th><th>بولسار</th><th>WP Minio</th><th>WP Local</th><th>الفسفور الابيض S3</th></tr>
</thead>
<tbody>
<tr><td>الإنتاجية</td><td>129.96 ميجابايت/ثانية</td><td>107 ميجابايت/ثانية</td><td>71 ميجابايت/ثانية</td><td>450 ميجابايت/ثانية</td><td>750 ميجابايت/ثانية</td></tr>
<tr><td>زمن الاستجابة</td><td>58 مللي ثانية</td><td>35 مللي ثانية</td><td>184 مللي ثانية</td><td>1.8 مللي ثانية</td><td>166 مللي ثانية</td></tr>
</tbody>
</table>
<p>بالنسبة للسياق، قمنا بقياس حدود الإنتاجية النظرية لخلفيات التخزين المختلفة على جهاز الاختبار الخاص بنا:</p>
<ul>
<li>MinIO: 110 ميجابايت/ثانية تقريبًا</li>
<li>نظام الملفات المحلي: 600-750 ميجابايت/ثانية</li>
<li>أمازون S3 (مثيل EC2 واحد): ما يصل إلى 1.1 جيجابايت/ثانية</li>
</ul>
<p>من اللافت للنظر أن Woodpecker حقق باستمرار 60-80% من أقصى إنتاجية ممكنة لكل واجهة خلفية - وهو مستوى كفاءة استثنائي للبرامج الوسيطة.</p>
<h3 id="Key-performance-insights" class="common-anchor-header">رؤى الأداء الرئيسية</h3><ul>
<li>وضع نظام الملفات المحلي: حقق Woodpecker سرعة 450 ميغابايت/ثانية - أسرع بـ 3.5 أضعاف من Kafka و4.2 أضعاف من Pulsar - مع زمن انتقال منخفض للغاية يبلغ 1.8 مللي ثانية فقط، مما يجعله مثاليًا لعمليات النشر عالية الأداء للعقدة الواحدة.</li>
<li>وضع التخزين السحابي (S3): عند الكتابة مباشرةً إلى S3، وصلت سرعة Woodpecker إلى 750 ميغابايت/ثانية (حوالي 68% من الحد النظري لـ S3)، أي أعلى بـ 5.8 ضعف من Kafka و7 أضعاف من Pulsar. في حين أن زمن الاستجابة أعلى (166 مللي ثانية)، يوفر هذا الإعداد إنتاجية استثنائية لأحمال العمل الموجهة نحو الدُفعات.</li>
<li>وضع تخزين الكائنات (MinIO): حتى مع MinIO، حقق Woodpecker 71 ميغابايت/ثانية - حوالي 65% من سعة MinIO. هذا الأداء مماثل لأداء Kafka وPulsar ولكن بمتطلبات موارد أقل بكثير.</li>
</ul>
<p>تم تحسين Woodpecker بشكل خاص للكتابات المتزامنة ذات الحجم الكبير حيث يكون الحفاظ على النظام أمرًا بالغ الأهمية. وتعكس هذه النتائج فقط المراحل المبكرة من التطوير - من المتوقع أن تؤدي التحسينات الجارية في دمج الإدخال/الإخراج، والتخزين المؤقت الذكي، والجلب المسبق إلى دفع الأداء إلى حدوده النظرية.</p>
<h2 id="Operational-benefits" class="common-anchor-header">الفوائد التشغيلية<button data-href="#Operational-benefits" class="anchor-icon" translate="no">
      <svg translate="no"
        aria-hidden="true"
        focusable="false"
        height="20"
        version="1.1"
        viewBox="0 0 16 16"
        width="16"
      >
        <path
          fill="#0092E4"
          fill-rule="evenodd"
          d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"
        ></path>
      </svg>
    </button></h2><p>توفر بنية Woodpecker السحابية الأصلية مزايا تشغيلية كبيرة:</p>
<ul>
<li><strong>انعدام إدارة التخزين المحلي</strong>: الاستغناء عن إدارة وحدة تخزين الأقراص وتكوين RAID وأعطال الأجهزة</li>
<li><strong>التحجيم التلقائي</strong>: توسيع نطاق التخزين مع تخزين الكائنات السحابية دون الحاجة إلى تخطيط السعة</li>
<li><strong>كفاءة التكلفة</strong>: تخزين الدفع حسب الاستخدام مع خاصية التخزين التلقائي والضغط التلقائي</li>
<li><strong>التوافر العالي</strong>: الاستفادة من متانة موفري الخدمات السحابية التي تصل إلى 11-9 مع الاسترداد السريع</li>
<li><strong>نشر مبسط</strong>: وضعان للنشر (MemoryBuffer/QuorBuffer) يتناسبان مع الاحتياجات التشغيلية المختلفة</li>
<li><strong>ملائمة للمطورين</strong>: إعداد أسرع للبيئة وبنية متسقة في جميع البيئات</li>
</ul>
<p>هذه المزايا تجعل من Woodpecker ذا قيمة خاصة للمهام الحرجة للمهام الحرجة RAG، ووكلاء الذكاء الاصطناعي، وأعباء عمل البحث ذات الكمون المنخفض حيث تكون البساطة التشغيلية مهمة مثل الأداء.</p>
