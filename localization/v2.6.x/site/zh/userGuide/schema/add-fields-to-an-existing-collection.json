{"codeList":["from pymilvus import MilvusClient, DataType\n\n# Connect to your Milvus server\nclient = MilvusClient(\n    uri=\"http://localhost:19530\"  # Replace with your Milvus server URI\n)\n","import io.milvus.v2.client.MilvusClientV2;\nimport io.milvus.v2.client.ConnectConfig;\n\nConnectConfig config = ConnectConfig.builder()\n        .uri(\"http://localhost:19530\")\n        .build();\nMilvusClientV2 client = new MilvusClientV2(config);\n","import { MilvusClient } from '@zilliz/milvus2-sdk-node';\n\nconst milvusClient = new MilvusClient({\n    address: 'localhost:19530'\n});\n","// go\n","# restful\nexport CLUSTER_ENDPOINT=\"localhost:19530\"\n","# Add a nullable field to an existing collection\n# This operation:\n# - Returns almost immediately (non-blocking)\n# - Makes the field available for use with minimal delay\n# - Sets NULL for all existing entities\nclient.add_collection_field(\n    collection_name=\"product_catalog\",\n    field_name=\"created_timestamp\",  # Name of the new field to add\n    data_type=DataType.INT64,        # Data type must be a scalar type\n    nullable=True                    # Must be True for added fields\n    # Allows NULL values for existing entities\n)\n","import io.milvus.v2.service.collection.request.AddCollectionFieldReq;\n\nclient.addCollectionField(AddCollectionFieldReq.builder()\n        .collectionName(\"product_catalog\")\n        .fieldName(\"created_timestamp\")\n        .dataType(DataType.Int64)\n        .isNullable(true)\n        .build());\n","await client.addCollectionField({\n    collection_name: 'product_catalog',\n    field: {\n        name: 'created_timestamp',\n        dataType: 'Int64',\n        nullable: true\n     }\n});\n","// go\n","# restful\ncurl -X POST \"http://localhost:19530/v2/vectordb/collections/fields/add\" \\\n  -H \"Content-Type: application/json\" \\\n  -H \"Authorization: Bearer <token>\" \\\n  -d '{\n    \"collectionName\": \"product_catalog\",\n    \"schema\": {\n      \"fieldName\": \"created_timestamp\",\n      \"dataType\": \"Int64\",\n      \"nullable\": true\n    }\n  }'\n","# Example query result\n{\n    'id': 1, \n    'created_timestamp': None  # New field shows NULL for existing entities\n}\n","// java\n","// nodejs\n{\n    'id': 1, \n    'created_timestamp': None  # New field shows NULL for existing entities\n}\n","// go\n","# restful\n{\n  \"code\": 0,\n  \"data\": {},\n  \"cost\": 0\n}\n","# Add a field with default value\n# This operation:\n# - Sets the default value for all existing entities\n# - Makes the field available with minimal delay\n# - Maintains data consistency with the default value\nclient.add_collection_field(\n    collection_name=\"product_catalog\",\n    field_name=\"priority_level\",     # Name of the new field\n    data_type=DataType.VARCHAR,      # String type field\n    max_length=20,                   # Maximum string length\n    nullable=True,                   # Required for added fields\n    default_value=\"standard\"         # Value assigned to existing entities\n    # Also used for new entities if no value provided\n)\n","client.addCollectionField(AddCollectionFieldReq.builder()\n        .collectionName(\"product_catalog\")\n        .fieldName(\"priority_level\")\n        .dataType(DataType.VarChar)\n        .maxLength(20)\n        .isNullable(true)\n        .build());\n","await client.addCollectionField({\n    collection_name: 'product_catalog',\n    field: {\n        name: 'priority_level',\n        dataType: 'VarChar',\n        nullable: true,\n        default_value: 'standard',\n     }\n});\n","// go\n","# restful\ncurl -X POST \"http://localhost:19530/v2/vectordb/collections/fields/add\" \\\n  -H \"Content-Type: application/json\" \\\n  -H \"Authorization: Bearer <token>\" \\\n  -d '{\n    \"collectionName\": \"product_catalog\",\n    \"schema\": {\n      \"fieldName\": \"priority_level\",\n      \"dataType\": \"VarChar\",\n      \"nullable\": true,\n      \"defaultValue\": \"standard\",\n      \"elementTypeParams\": {\n        \"max_length\": \"20\"\n      }\n    }\n  }'\n","# Example query result\n{\n    'id': 1,\n    'priority_level': 'standard'  # Shows default value for existing entities\n}\n","// java\n","{\n    'id': 1,\n    'priority_level': 'standard'  # Shows default value for existing entities\n}\n","// go\n","# restful\n{\n    'id': 1,\n    'priority_level': 'standard'  # Shows default value for existing entities\n}\n","# ❌ This is NOT supported\nclient.add_collection_field(\n    collection_name=\"existing_collection\",\n    field_name=\"$meta\",\n    data_type=DataType.JSON  # This operation will fail\n)\n","// ❌ This is NOT supported\nclient.addCollectionField(AddCollectionFieldReq.builder()\n        .collectionName(\"existing_collection\")\n        .fieldName(\"$meta\")\n        .dataType(DataType.JSON)\n        .build());\n","// ❌ This is NOT supported\nawait client.addCollectionField({\n    collection_name: 'product_catalog',\n    field: {\n        name: '$meta',\n        dataType: 'JSON',\n     }\n});\n","// go\n","# restful\n# ❌ This is NOT supported\ncurl -X POST \"http://localhost:19530/v2/vectordb/collections/fields/add\" \\\n  -H \"Content-Type: application/json\" \\\n  -H \"Authorization: Bearer <token>\" \\\n  -d '{\n    \"collectionName\": \"existing_collection\",\n    \"schema\": {\n      \"fieldName\": \"$meta\",\n      \"dataType\": \"JSON\",\n      \"nullable\": true\n    }\n  }'\n","# Original collection with dynamic field enabled\n# Insert data with dynamic field keys\ndata = [{\n    \"id\": 1,\n    \"my_vector\": [0.1, 0.2, ...],\n    \"extra_info\": \"this is a dynamic field key\",  # Dynamic field key as string\n    \"score\": 99.5                                 # Another dynamic field key\n}]\nclient.insert(collection_name=\"product_catalog\", data=data)\n\n# Add static field with same name as existing dynamic field key\nclient.add_collection_field(\n    collection_name=\"product_catalog\",\n    field_name=\"extra_info\",         # Same name as dynamic field key\n    data_type=DataType.INT64,        # Data type can differ from dynamic field key\n    nullable=True                    # Must be True for added fields\n)\n\n# Insert new data after adding static field\nnew_data = [{\n    \"id\": 2,\n    \"my_vector\": [0.3, 0.4, ...],\n    \"extra_info\": 100,               # Now must use INT64 type (static field)\n    \"score\": 88.0                    # Still a dynamic field key\n}]\nclient.insert(collection_name=\"product_catalog\", data=new_data)\n","import com.google.gson.*;\nimport io.milvus.v2.service.vector.request.InsertReq;\nimport io.milvus.v2.service.vector.response.InsertResp;\n\nGson gson = new Gson();\nJsonObject row = new JsonObject();\nrow.addProperty(\"id\", 1);\nrow.add(\"my_vector\", gson.toJsonTree(new float[]{0.1f, 0.2f, ...}));\nrow.addProperty(\"extra_info\", \"this is a dynamic field key\");\nrow.addProperty(\"score\", 99.5);\n\nInsertResp insertR = client.insert(InsertReq.builder()\n        .collectionName(\"product_catalog\")\n        .data(Collections.singletonList(row))\n        .build());\n        \nclient.addCollectionField(AddCollectionFieldReq.builder()\n        .collectionName(\"product_catalog\")\n        .fieldName(\"extra_info\")\n        .dataType(DataType.Int64)\n        .isNullable(true)\n        .build());\n        \nJsonObject newRow = new JsonObject();\nnewRow.addProperty(\"id\", 2);\nnewRow.add(\"my_vector\", gson.toJsonTree(new float[]{0.3f, 0.4f, ...}));\nnewRow.addProperty(\"extra_info\", 100);\nnewRow.addProperty(\"score\", 88.0);\n\ninsertR = client.insert(InsertReq.builder()\n        .collectionName(\"product_catalog\")\n        .data(Collections.singletonList(newRow))\n        .build());\n","// Original collection with dynamic field enabled\n// Insert data with dynamic field keys\nconst data = [{\n    \"id\": 1,\n    \"my_vector\": [0.1, 0.2, ...],\n    \"extra_info\": \"this is a dynamic field key\",  // Dynamic field key as string\n    \"score\": 99.5                                 // Another dynamic field key\n}]\nawait client.insert({\n    collection_name: \"product_catalog\", \n    data: data\n});\n\n// Add static field with same name as existing dynamic field key\nawait client.add_collection_field({\n    collection_name: \"product_catalog\",\n    field_name: \"extra_info\",         // Same name as dynamic field key\n    data_type: DataType.INT64,        // Data type can differ from dynamic field key\n    nullable: true                   // Must be True for added fields\n});\n\n// Insert new data after adding static field\nconst new_data = [{\n    \"id\": 2,\n    \"my_vector\": [0.3, 0.4, ...],\n    \"extra_info\": 100,               # Now must use INT64 type (static field)\n    \"score\": 88.0                    # Still a dynamic field key\n}];\n\nawait client.insert({\n    collection_name:\"product_catalog\", \n    data: new_data\n});\n","// go\n","# restful\n#!/bin/bash\n\nexport MILVUS_HOST=\"localhost:19530\"\nexport AUTH_TOKEN=\"your_token_here\"\nexport COLLECTION_NAME=\"product_catalog\"\n\necho \"Step 1: Insert initial data with dynamic fields...\"\ncurl -X POST \"http://${MILVUS_HOST}/v2/vectordb/entities/insert\" \\\n  -H \"Content-Type: application/json\" \\\n  -H \"Authorization: Bearer ${AUTH_TOKEN}\" \\\n  -d \"{\n    \\\"collectionName\\\": \\\"${COLLECTION_NAME}\\\",\n    \\\"data\\\": [{\n      \\\"id\\\": 1,\n      \\\"my_vector\\\": [0.1, 0.2, 0.3, 0.4, 0.5],\n      \\\"extra_info\\\": \\\"this is a dynamic field key\\\",\n      \\\"score\\\": 99.5\n    }]\n  }\"\n\necho -e \"\\n\\nStep 2: Add static field with same name as dynamic field...\"\ncurl -X POST \"http://${MILVUS_HOST}/v2/vectordb/collections/fields/add\" \\\n  -H \"Content-Type: application/json\" \\\n  -H \"Authorization: Bearer ${AUTH_TOKEN}\" \\\n  -d \"{\n    \\\"collectionName\\\": \\\"${COLLECTION_NAME}\\\",\n    \\\"schema\\\": {\n      \\\"fieldName\\\": \\\"extra_info\\\",\n      \\\"dataType\\\": \\\"Int64\\\",\n      \\\"nullable\\\": true\n    }\n  }\"\n\necho -e \"\\n\\nStep 3: Insert new data after adding static field...\"\ncurl -X POST \"http://${MILVUS_HOST}/v2/vectordb/entities/insert\" \\\n  -H \"Content-Type: application/json\" \\\n  -H \"Authorization: Bearer ${AUTH_TOKEN}\" \\\n  -d \"{\n    \\\"collectionName\\\": \\\"${COLLECTION_NAME}\\\",\n    \\\"data\\\": [{\n      \\\"id\\\": 2,\n      \\\"my_vector\\\": [0.3, 0.4, 0.5, 0.6, 0.7],\n      \\\"extra_info\\\": 100,\n      \\\"score\\\": 88.0\n    }]\n  }\"\n","# 1. Query static field only (dynamic field key is masked)\nresults = client.query(\n    collection_name=\"product_catalog\",\n    filter=\"id == 1\",\n    output_fields=[\"extra_info\"]\n)\n# Returns: {\"id\": 1, \"extra_info\": None}  # NULL for existing entity\n\n# 2. Query both static and original dynamic values\nresults = client.query(\n    collection_name=\"product_catalog\", \n    filter=\"id == 1\",\n    output_fields=[\"extra_info\", \"$meta['extra_info']\"]\n)\n# Returns: {\n#     \"id\": 1,\n#     \"extra_info\": None,                           # Static field value (NULL)\n#     \"$meta['extra_info']\": \"this is a dynamic field key\"  # Original dynamic value\n# }\n\n# 3. Query new entity with static field value\nresults = client.query(\n    collection_name=\"product_catalog\",\n    filter=\"id == 2\", \n    output_fields=[\"extra_info\"]\n)\n# Returns: {\"id\": 2, \"extra_info\": 100}  # Static field value\n","// java\n","// 1. Query static field only (dynamic field key is masked)\nlet results = client.query({\n    collection_name: \"product_catalog\",\n    filter: \"id == 1\",\n    output_fields: [\"extra_info\"]\n})\n// Returns: {\"id\": 1, \"extra_info\": None}  # NULL for existing entity\n\n// 2. Query both static and original dynamic values\nresults = client.query({\n    collection_name:\"product_catalog\", \n    filter: \"id == 1\",\n    output_fields: [\"extra_info\", \"$meta['extra_info']\"]\n});\n// Returns: {\n//     \"id\": 1,\n//     \"extra_info\": None,                           # Static field value (NULL)\n//     \"$meta['extra_info']\": \"this is a dynamic field key\"  # Original dynamic value\n// }\n\n// 3. Query new entity with static field value\nresults = client.query({\n    collection_name: \"product_catalog\",\n    filter: \"id == 2\", \n    output_fields: [\"extra_info\"]\n})\n// Returns: {\"id\": 2, \"extra_info\": 100}  # Static field value\n","// go\n","# restful\n#!/bin/bash\n\nexport MILVUS_HOST=\"localhost:19530\"\nexport AUTH_TOKEN=\"your_token_here\"\nexport COLLECTION_NAME=\"product_catalog\"\n\necho \"Query 1: Static field only (dynamic field masked)...\"\ncurl -X POST \"http://${MILVUS_HOST}/v2/vectordb/entities/query\" \\\n  -H \"Content-Type: application/json\" \\\n  -H \"Authorization: Bearer ${AUTH_TOKEN}\" \\\n  -d \"{\n    \\\"collectionName\\\": \\\"${COLLECTION_NAME}\\\",\n    \\\"filter\\\": \\\"id == 1\\\",\n    \\\"outputFields\\\": [\\\"extra_info\\\"]\n  }\"\n\necho -e \"\\n\\nQuery 2: Both static and original dynamic values...\"\ncurl -X POST \"http://${MILVUS_HOST}/v2/vectordb/entities/query\" \\\n  -H \"Content-Type: application/json\" \\\n  -H \"Authorization: Bearer ${AUTH_TOKEN}\" \\\n  -d \"{\n    \\\"collectionName\\\": \\\"${COLLECTION_NAME}\\\",\n    \\\"filter\\\": \\\"id == 1\\\",\n    \\\"outputFields\\\": [\\\"extra_info\\\", \\\"\\$meta['extra_info']\\\"]\n  }\"\n\necho -e \"\\n\\nQuery 3: New entity with static field value...\"\ncurl -X POST \"http://${MILVUS_HOST}/v2/vectordb/entities/query\" \\\n  -H \"Content-Type: application/json\" \\\n  -H \"Authorization: Bearer ${AUTH_TOKEN}\" \\\n  -d \"{\n    \\\"collectionName\\\": \\\"${COLLECTION_NAME}\\\",\n    \\\"filter\\\": \\\"id == 2\\\",\n    \\\"outputFields\\\": [\\\"extra_info\\\"]\n  }\"\n"],"headingContent":"Add Fields to an Existing Collection","anchorList":[{"label":"向现有 Collections 添加字段Compatible with Milvus 2.6.x","href":"Add-Fields-to-an-Existing-Collection","type":1,"isActive":false},{"label":"注意事项","href":"Considerations","type":2,"isActive":false},{"label":"前提条件","href":"Prerequisites","type":2,"isActive":false},{"label":"基本用法","href":"Basic-usage","type":2,"isActive":false},{"label":"场景 1：快速添加可空字段","href":"Scenario-1-Quickly-add-nullable-fields","type":2,"isActive":false},{"label":"方案 2：添加带默认值的字段","href":"Scenario-2-Add-fields-with-default-values","type":2,"isActive":false},{"label":"常见问题","href":"FAQ","type":2,"isActive":false},{"label":"是否可以通过添加$meta 字段来启用动态 Schema 功能？","href":"Can-I-enable-dynamic-schema-functionality-by-adding-a-meta-field","type":3,"isActive":false},{"label":"添加与动态字段关键字同名的字段时会发生什么情况？","href":"What-happens-when-I-add-a-field-with-the-same-name-as-a-dynamic-field-key","type":3,"isActive":false},{"label":"新字段可用需要多长时间？","href":"How-long-does-it-take-for-a-new-field-to-become-available","type":3,"isActive":false}]}