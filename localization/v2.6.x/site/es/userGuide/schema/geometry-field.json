{"codeList":["from pymilvus import MilvusClient, DataType\nimport numpy as np\n\ndim = 8\ncollection_name = \"geo_collection\"\nmilvus_client = MilvusClient(\"http://localhost:19530\")\n\n# Create schema with a GEOMETRY field\nschema = milvus_client.create_schema(enable_dynamic_field=True)\nschema.add_field(\"id\", DataType.INT64, is_primary=True)\nschema.add_field(\"embeddings\", DataType.FLOAT_VECTOR, dim=dim)\n# highlight-next-line\nschema.add_field(\"geo\", DataType.GEOMETRY, nullable=True)\nschema.add_field(\"name\", DataType.VARCHAR, max_length=128)\n\nmilvus_client.create_collection(collection_name, schema=schema, consistency_level=\"Strong\")\n","import io.milvus.v2.client.ConnectConfig;\nimport io.milvus.v2.client.MilvusClientV2;\nimport io.milvus.v2.common.DataType;\n\nprivate static final String COLLECTION_NAME = \"geo_collection\";\nprivate static final Integer DIM = 128;\n\nMilvusClientV2 client = new MilvusClientV2(ConnectConfig.builder()\n        .uri(\"http://localhost:19530\")\n        .token(\"root:Milvus\")\n        .build());\n        \nCreateCollectionReq.CollectionSchema collectionSchema = CreateCollectionReq.CollectionSchema.builder()\n        .enableDynamicField(true)\n        .build();\ncollectionSchema.addField(AddFieldReq.builder()\n        .fieldName(\"id\")\n        .dataType(DataType.Int64)\n        .isPrimaryKey(true)\n        .build());\ncollectionSchema.addField(AddFieldReq.builder()\n        .fieldName(\"embeddings\")\n        .dataType(DataType.FloatVector)\n        .dimension(DIM)\n        .build());\ncollectionSchema.addField(AddFieldReq.builder()\n        .fieldName(\"geo\")\n        .dataType(DataType.Geometry)\n        .isNullable(true)\n        .build());\ncollectionSchema.addField(AddFieldReq.builder()\n        .fieldName(\"name\")\n        .dataType(DataType.VarChar)\n        .maxLength(128)\n        .build());\n        \nCreateCollectionReq requestCreate = CreateCollectionReq.builder()\n        .collectionName(COLLECTION_NAME)\n        .collectionSchema(collectionSchema)\n        .build();\nclient.createCollection(requestCreate);\n\n","import { MilvusClient, DataType } from '@zilliz/milvus2-sdk-node';\n\nconst milvusClient = new MilvusClient('http://localhost:19530');\nconst schema = [\n  { name: 'id', data_type: DataType.Int64, is_primary_key: true },\n  { name: 'embeddings', data_type: DataType.FloatVector, dim: 8 },\n  // highlight-next-line\n  { name: 'geo', data_type: DataType.Geometry, is_nullable: true },\n  { name: 'name', data_type: DataType.VarChar, max_length: 128 },\n];\n\nawait milvusClient.createCollection({\n  collection_name: 'geo_collection',\n  fields: schema,\n  consistency_level: 'Strong',\n});\n","// go\n","# restful\n\n","rng = np.random.default_rng(seed=19530)\ngeo_points = [\n    'POINT(13.399710 52.518010)',\n    'POINT(13.403934 52.522877)',\n    'POINT(13.405088 52.521124)',\n    'POINT(13.408223 52.516876)',\n    'POINT(13.400092 52.521507)',\n    'POINT(13.408529 52.519274)',\n]\n\nrows = [\n    {\"id\": 1, \"name\": \"Shop A\", \"embeddings\": rng.random((1, dim))[0], \"geo\": geo_points[0]},\n    {\"id\": 2, \"name\": \"Shop B\", \"embeddings\": rng.random((1, dim))[0], \"geo\": geo_points[1]},\n    {\"id\": 3, \"name\": \"Shop C\", \"embeddings\": rng.random((1, dim))[0], \"geo\": geo_points[2]},\n    {\"id\": 4, \"name\": \"Shop D\", \"embeddings\": rng.random((1, dim))[0], \"geo\": geo_points[3]},\n    {\"id\": 5, \"name\": \"Shop E\", \"embeddings\": rng.random((1, dim))[0], \"geo\": geo_points[4]},\n    {\"id\": 6, \"name\": \"Shop F\", \"embeddings\": rng.random((1, dim))[0], \"geo\": geo_points[5]},\n]\n\ninsert_result = milvus_client.insert(collection_name, rows)\nprint(insert_result)\n\n# Expected output:\n# {'insert_count': 6, 'ids': [1, 2, 3, 4, 5, 6]}\n","import com.google.gson.Gson;\nimport com.google.gson.JsonObject;\nimport io.milvus.v2.service.vector.request.InsertReq;\n\nList<String> geoPoints = Arrays.asList(\n        \"POINT(13.399710 52.518010)\",\n        \"POINT(13.403934 52.522877)\",\n        \"POINT(13.405088 52.521124)\",\n        \"POINT(13.408223 52.516876)\",\n        \"POINT(13.400092 52.521507)\",\n        \"POINT(13.408529 52.519274)\"\n);\nList<String> names = Arrays.asList(\"Shop A\", \"Shop B\", \"Shop C\", \"Shop D\", \"Shop E\", \"Shop F\");\nRandom ran = new Random();\nGson gson = new Gson();\nList<JsonObject> rows = new ArrayList<>();\nfor (int i = 0; i < geoPoints.size(); i++) {\n    JsonObject row = new JsonObject();\n    row.addProperty(\"id\", i);\n    row.addProperty(\"geo\", geoPoints.get(i));\n    row.addProperty(\"name\", names.get(i));\n    List<Float> vector = new ArrayList<>();\n    for (int d = 0; d < DIM; ++d) {\n        vector.add(ran.nextFloat());\n    }\n    row.add(\"embeddings\", gson.toJsonTree(vector));\n    rows.add(row);\n}\n\nclient.insert(InsertReq.builder()\n        .collectionName(COLLECTION_NAME)\n        .data(rows)\n        .build());\n","const geo_points = [\n    'POINT(13.399710 52.518010)',\n    'POINT(13.403934 52.522877)',\n    'POINT(13.405088 52.521124)',\n    'POINT(13.408223 52.516876)',\n    'POINT(13.400092 52.521507)',\n    'POINT(13.408529 52.519274)',\n];\n\nconst rows = [\n    {\"id\": 1, \"name\": \"Shop A\", \"embeddings\": [0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8], \"geo\": geo_points[0]},\n    {\"id\": 2, \"name\": \"Shop B\", \"embeddings\": [0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9], \"geo\": geo_points[1]},\n    {\"id\": 3, \"name\": \"Shop C\", \"embeddings\": [0.3,0.4,0.5,0.6,0.7,0.8,0.9,1.0], \"geo\": geo_points[2]},\n    {\"id\": 4, \"name\": \"Shop D\", \"embeddings\": [0.4,0.5,0.6,0.7,0.8,0.9,1.0,0.1], \"geo\": geo_points[3]},\n    {\"id\": 5, \"name\": \"Shop E\", \"embeddings\": [0.5,0.6,0.7,0.8,0.9,1.0,0.1,0.2], \"geo\": geo_points[4]},\n    {\"id\": 6, \"name\": \"Shop F\", \"embeddings\": [0.6,0.7,0.8,0.9,1.0,0.1,0.2,0.3], \"geo\": geo_points[5]},\n];\n\nconst insert_result = await milvusClient.insert({\n  collection_name: 'geo_collection',\n  data: rows,\n});\nconsole.log(insert_result);\n","// go\n","# restful\n","index_params = milvus_client.prepare_index_params()\nindex_params.add_index(field_name=\"embeddings\", metric_type=\"L2\")\n\nmilvus_client.create_index(collection_name, index_params)\nmilvus_client.load_collection(collection_name)\n","import io.milvus.v2.common.IndexParam;\nimport io.milvus.v2.service.index.request.CreateIndexReq;\n\nList<IndexParam> indexParams = new ArrayList<>();\nindexParams.add(IndexParam.builder()\n        .fieldName(\"embeddings\")\n        .indexType(IndexParam.IndexType.AUTOINDEX)\n        .metricType(IndexParam.MetricType.L2)\n        .build());\nclient.createIndex(CreateIndexReq.builder()\n        .collectionName(COLLECTION_NAME)\n        .indexParams(indexParams)\n        .build());\n","\nconst index_params = {\n  field_name: \"embeddings\",\n  index_type: \"IVF_FLAT\",\n  metric_type: \"L2\",\n  params: { nlist: 128 },\n};\n\nawait milvusClient.createIndex({\n  collection_name: 'geo_collection',\n  index_name: 'embeddings_index',\n  index_params: index_params,\n});\n\nawait milvusClient.loadCollection({\n  collection_name: 'geo_collection',\n});\n","// go\n","# restful\n","top_left_lon, top_left_lat = 13.403683, 52.520711\nbottom_right_lon, bottom_right_lat = 13.455868, 52.495862\nbounding_box_wkt = f\"POLYGON(({top_left_lon} {top_left_lat}, {bottom_right_lon} {top_left_lat}, {bottom_right_lon} {bottom_right_lat}, {top_left_lon} {bottom_right_lat}, {top_left_lon} {top_left_lat}))\"\n\nquery_results = milvus_client.query(\n    collection_name,\n    # highlight-next-line\n    filter=f\"st_within(geo, '{bounding_box_wkt}')\",\n    output_fields=[\"name\", \"geo\"]\n)\nfor ret in query_results:\n    print(ret)\n    \n# Expected output:\n# {'name': 'Shop D', 'geo': 'POINT (13.408223 52.516876)', 'id': 4}\n# {'name': 'Shop F', 'geo': 'POINT (13.408529 52.519274)', 'id': 6}\n# {'name': 'Shop A', 'geo': 'POINT (13.39971 52.51801)', 'id': 1}\n# {'name': 'Shop B', 'geo': 'POINT (13.403934 52.522877)', 'id': 2}\n# {'name': 'Shop C', 'geo': 'POINT (13.405088 52.521124)', 'id': 3}\n# {'name': 'Shop D', 'geo': 'POINT (13.408223 52.516876)', 'id': 4}\n# {'name': 'Shop E', 'geo': 'POINT (13.400092 52.521507)', 'id': 5}\n# {'name': 'Shop F', 'geo': 'POINT (13.408529 52.519274)', 'id': 6}\n","import io.milvus.v2.service.vector.request.QueryReq;\nimport io.milvus.v2.service.vector.response.QueryResp;\n\nfloat topLeftLon = 13.403683f;\nfloat topLeftLat = 52.520711f;\nfloat bottomRightLon = 13.455868f;\nfloat bottomRightLat = 52.495862f;\nString boundingBoxWkt = String.format(\"POLYGON((%f %f, %f %f, %f %f, %f %f, %f %f))\",\n        topLeftLon, topLeftLat, bottomRightLon, topLeftLat, bottomRightLon, bottomRightLat,\n        topLeftLon, bottomRightLat, topLeftLon, topLeftLat);\n\nString filter = String.format(\"st_within(geo, '%s')\", boundingBoxWkt);\nQueryResp queryResp = client.query(QueryReq.builder()\n        .collectionName(COLLECTION_NAME)\n        .filter(filter)\n        .outputFields(Arrays.asList(\"name\", \"geo\"))\n        .build());\nList<QueryResp.QueryResult> queryResults = queryResp.getQueryResults();\nSystem.out.println(\"Query results:\");\nfor (QueryResp.QueryResult result : queryResults) {\n    System.out.println(result.getEntity());\n}\n","const top_left_lon = 13.403683;\nconst top_left_lat = 52.520711;\nconst bottom_right_lon = 13.455868;\nconst bottom_right_lat = 52.495862;\nconst bounding_box_wkt = `POLYGON((${top_left_lon} ${top_left_lat}, ${bottom_right_lon} ${top_left_lat}, ${bottom_right_lon} ${bottom_right_lat}, ${top_left_lon} ${bottom_right_lat}, ${top_left_lon} ${top_left_lat}))`;\n\nconst query_results = await milvusClient.query({\n  collection_name: 'geo_collection',\n  // highlight-next-line\n  filter: `st_within(geo, '${bounding_box_wkt}')`,\n  output_fields: ['name', 'geo'],\n});\nfor (const ret of query_results.data) {\n    console.log(ret);\n}\n","// go\n","# restful\n","center_point_lon, center_point_lat = 13.403683, 52.520711\nradius_meters = 1000.0\ncentral_point_wkt = f\"POINT({center_point_lon} {center_point_lat})\"\n\nquery_results = milvus_client.query(\n    collection_name,\n    # highlight-next-line\n    filter=f\"st_dwithin(geo, '{central_point_wkt}', {radius_meters})\",\n    output_fields=[\"name\", \"geo\"]\n)\nfor ret in query_results:\n    print(ret)\n    \n# Expected output:\n# hit: {'id': 4, 'distance': 0.9823770523071289, 'entity': {'name': 'Shop D', 'geo': 'POINT (13.408223 52.516876)'}}\n","import io.milvus.v2.service.vector.request.QueryReq;\nimport io.milvus.v2.service.vector.response.QueryResp;\n\nfloat centerPointLon = 13.403683f;\nfloat centerPointLat = 52.520711f;\nfloat radiusMeters = 1000.0f;\nString centralPointWkt = String.format(\"POINT(%f %f)\", centerPointLon, centerPointLat);\nString filter=String.format(\"st_dwithin(geo, '%s', %f)\", centralPointWkt, radiusMeters);\nQueryResp queryResp = client.query(QueryReq.builder()\n        .collectionName(COLLECTION_NAME)\n        .filter(filter)\n        .outputFields(Arrays.asList(\"name\", \"geo\"))\n        .build());\nList<QueryResp.QueryResult> queryResults = queryResp.getQueryResults();\nSystem.out.println(\"Query results:\");\nfor (QueryResp.QueryResult result : queryResults) {\n    System.out.println(result.getEntity());\n}\n","const center_point_lon = 13.403683;\nconst center_point_lat = 52.520711;\nconst radius_meters = 1000.0;\nconst central_point_wkt = `POINT(${center_point_lon} ${center_point_lat})`;\n\nconst query_results_dwithin = await milvusClient.query({\n  collection_name: 'geo_collection',\n  // highlight-next-line\n  filter: `st_dwithin(geo, '${central_point_wkt}', ${radius_meters})`,\n  output_fields: ['name', 'geo'],\n});\nfor (const ret of query_results_dwithin.data) {\n    console.log(ret);\n}\n","// go\n","# restful\n","vectors_to_search = rng.random((1, dim))\nresult = milvus_client.search(\n    collection_name,\n    vectors_to_search,\n    limit=3,\n    output_fields=[\"name\", \"geo\"],\n    # highlight-next-line\n    filter=f\"st_within(geo, '{bounding_box_wkt}')\"\n)\nfor hits in result:\n    for hit in hits:\n        print(f\"hit: {hit}\")\n        \n# Expected output:\n# hit: {'id': 6, 'distance': 1.3406795263290405, 'entity': {'name': 'Shop F', 'geo': 'POINT (13.408529 52.519274)'}}\n","import io.milvus.v2.service.vector.request.SearchReq;\nimport io.milvus.v2.service.vector.request.data.FloatVec;\nimport io.milvus.v2.service.vector.response.SearchResp;\n\nRandom ran = new Random();\nList<Float> vector = new ArrayList<>();\nfor (int d = 0; d < DIM; ++d) {\n    vector.add(ran.nextFloat());\n}\nString filter=String.format(\"st_within(geo, '%s')\", boundingBoxWkt);\nSearchReq request = SearchReq.builder()\n        .collectionName(COLLECTION_NAME)\n        .data(Collections.singletonList(new FloatVec(vector)))\n        .limit(3)\n        .filter(filter)\n        .outputFields(Arrays.asList(\"name\", \"geo\"))\n        .build();\nSearchResp statusR = client.search(request);\nList<List<SearchResp.SearchResult>> searchResults = statusR.getSearchResults();\nfor (List<SearchResp.SearchResult> results : searchResults) {\n    for (SearchResp.SearchResult result : results) {\n        System.out.printf(\"ID: %d, Score: %f, %s\\n\", (long)result.getId(), result.getScore(), result.getEntity().toString());\n    }\n}\n","const vectors_to_search = [[0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8]];\nconst search_results = await milvusClient.search({\n  collection_name: \"geo_collection\",\n  vectors: vectors_to_search,\n  limit: 3,\n  output_fields: [\"name\", \"geo\"],\n  // highlight-next-line\n  filter: `st_within(geo, '${bounding_box_wkt}')`,\n});\nfor (const hits of search_results.results) {\n  for (const hit of hits) {\n    console.log(`hit: ${JSON.stringify(hit)}`);\n  }\n}\n","// go\n","# restful\n"],"headingContent":"Geometry Field","anchorList":[{"label":"Campo GeometríaCompatible with Milvus 2.6.4+","href":"Geometry-Field","type":1,"isActive":false},{"label":"¿Qué es un campo GEOMETRÍA?","href":"What-is-a-GEOMETRY-field","type":2,"isActive":false},{"label":"Operaciones básicas","href":"Basic-operations","type":2,"isActive":false},{"label":"Paso 1: Definir un campo GEOMETRÍA","href":"Step-1-Define-a-GEOMETRY-field","type":3,"isActive":false},{"label":"Paso 2: Insertar datos","href":"Step-2-Insert-data","type":3,"isActive":false},{"label":"Paso 3: Operaciones de filtrado","href":"Step-3-Filtering-operations","type":3,"isActive":false},{"label":"A continuación Acelerar las consultas","href":"Next-Accelerate-queries","type":2,"isActive":false},{"label":"PREGUNTAS FRECUENTES","href":"FAQ","type":2,"isActive":false},{"label":"Si he activado la función de campo dinámico para mi colección, ¿puedo insertar datos geométricos en una clave de campo dinámico?","href":"If-Ive-enabled-the-dynamic-field-feature-for-my-collection-can-I-insert-geometric-data-into-a-dynamic-field-key","type":3,"isActive":false},{"label":"¿Es compatible el campo GEOMETRY con la función mmap?","href":"Does-the-GEOMETRY-field-support-the-mmap-feature","type":3,"isActive":false},{"label":"¿Puedo definir el campo GEOMETRY como anulable o establecer un valor por defecto?","href":"Can-I-define-the-GEOMETRY-field-as-nullable-or-set-a-default-value","type":3,"isActive":false}]}