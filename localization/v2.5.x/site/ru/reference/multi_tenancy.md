---
id: multi_tenancy.md
title: Внедрение многопользовательской аренды
summary: >-
  В Milvus многопользовательский режим означает, что несколько клиентов или
  команд, называемых арендаторами, используют один и тот же кластер, сохраняя
  при этом изолированные среды данных.
---
<h1 id="Implement-Multi-tenancy" class="common-anchor-header">Внедрение многопользовательской аренды<button data-href="#Implement-Multi-tenancy" class="anchor-icon" translate="no">
      <svg translate="no"
        aria-hidden="true"
        focusable="false"
        height="20"
        version="1.1"
        viewBox="0 0 16 16"
        width="16"
      >
        <path
          fill="#0092E4"
          fill-rule="evenodd"
          d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"
        ></path>
      </svg>
    </button></h1><p>В Milvus многопользовательская среда означает, что несколько клиентов или команд, называемых <strong>арендаторами,</strong>используют один и тот же кластер, сохраняя при этом изолированные среды данных.</p>
<p>Milvus поддерживает четыре стратегии многопользовательской работы, каждая из которых предлагает различные компромиссы между масштабируемостью, изоляцией данных и гибкостью. В этом руководстве мы рассмотрим каждый вариант и поможем вам выбрать наиболее подходящую стратегию для вашего случая использования.</p>
<h2 id="Multi-tenancy-strategies" class="common-anchor-header">Стратегии многопользовательской работы<button data-href="#Multi-tenancy-strategies" class="anchor-icon" translate="no">
      <svg translate="no"
        aria-hidden="true"
        focusable="false"
        height="20"
        version="1.1"
        viewBox="0 0 16 16"
        width="16"
      >
        <path
          fill="#0092E4"
          fill-rule="evenodd"
          d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"
        ></path>
      </svg>
    </button></h2><p>Milvus поддерживает многопользовательскую работу на четырех уровнях: <strong>База данных</strong>, <strong>Коллекция</strong>, <strong>Раздел</strong> и <strong>Ключ раздела</strong>.</p>
<h3 id="Database-level-multi-tenancy" class="common-anchor-header">Мультиарендность на уровне базы данных</h3><p>При многопользовательстве на уровне базы данных каждый арендатор получает соответствующую <a href="/docs/ru/manage_databases.md">базу данных</a>, содержащую одну или несколько коллекций.</p>
<p>
  
   <span class="img-wrapper"> <img translate="no" src="/docs/v2.5.x/assets/database-level-multi-tenancy.png" alt="Database Level Multi Tenancy" class="doc-image" id="database-level-multi-tenancy" />
   </span> <span class="img-wrapper"> <span>Многоарендность на уровне базы данных</span> </span></p>
<ul>
<li><p><strong>Масштабируемость</strong>: Стратегия многопользовательской аренды на уровне базы данных по умолчанию поддерживает максимум 64 арендатора.</p></li>
<li><p><strong>Изоляция данных</strong>: Данные в каждой базе данных полностью разделены, что обеспечивает изоляцию данных корпоративного уровня, идеальную для регулируемых сред или клиентов со строгими требованиями к соблюдению нормативных требований.</p></li>
<li><p><strong>Гибкость</strong>: В каждой базе данных могут быть коллекции с различными схемами, что обеспечивает гибкую организацию данных и позволяет каждому арендатору иметь собственную схему данных.</p></li>
<li><p><strong>Другие</strong>: Эта стратегия также поддерживает RBAC, позволяя осуществлять тонкий контроль над доступом пользователей для каждого арендатора. Кроме того, вы можете гибко загружать или освобождать данные для определенных арендаторов, чтобы эффективно управлять "горячими" и "холодными" данными.</p></li>
</ul>
<h3 id="Collection-level-multi-tenancy" class="common-anchor-header">Многопользовательская лицензия на уровне коллекции</h3><p>При многопользовательской системе на уровне коллекций каждому арендатору назначается своя <a href="/docs/ru/manage-collections.md">коллекция</a>, что обеспечивает надежную изоляцию данных.</p>
<p>
  
   <span class="img-wrapper"> <img translate="no" src="/docs/v2.5.x/assets/collection-level-multi-tenancy.png" alt="Collection Level Multi Tenancy" class="doc-image" id="collection-level-multi-tenancy" />
   </span> <span class="img-wrapper"> <span>Мультиарендность на уровне коллекций</span> </span></p>
<ul>
<li><p><strong>Масштабируемость</strong>: Поскольку кластер по умолчанию может содержать до 65 536 коллекций, эта стратегия позволяет разместить такое же количество арендаторов в кластере.</p></li>
<li><p><strong>Изоляция данных</strong>: Коллекции физически изолированы друг от друга. Эта стратегия обеспечивает надежную изоляцию данных.</p></li>
<li><p><strong>Гибкость</strong>: Эта стратегия позволяет каждой коллекции иметь собственную схему, что позволяет разместить арендаторов с различными схемами данных.</p></li>
<li><p><strong>Другие</strong>: Эта стратегия также поддерживает RBAC, позволяя осуществлять гранулярный контроль доступа для арендаторов. Кроме того, вы можете гибко загружать или освобождать данные для определенных арендаторов, чтобы эффективно управлять "горячими" и "холодными" данными.</p></li>
</ul>
<h3 id="Partition-level-multi-tenancy" class="common-anchor-header">Многопользовательская лицензия на уровне разделов</h3><p>При многопользовательской системе на уровне разделов каждый арендатор назначается на созданный вручную <a href="/docs/ru/manage-partitions.md">раздел</a> в общей коллекции.</p>
<p>
  
   <span class="img-wrapper"> <img translate="no" src="/docs/v2.5.x/assets/partition-level-multi-tenancy.png" alt="Partition Level Multi Tenancy" class="doc-image" id="partition-level-multi-tenancy" />
   </span> <span class="img-wrapper"> <span>Многопользовательская аренда на уровне разделов</span> </span></p>
<ul>
<li><p><strong>Масштабируемость</strong>: Коллекция может содержать до 1 024 разделов, что позволяет разместить в ней такое же количество арендаторов.</p></li>
<li><p><strong>Изоляция данных</strong>: Данные каждого арендатора физически разделены разделами.</p></li>
<li><p><strong>Гибкость</strong>: Эта стратегия требует, чтобы все арендаторы использовали одну и ту же схему данных. А разделы необходимо создавать вручную.</p></li>
<li><p><strong>Другие</strong>: RBAC не поддерживается на уровне разделов. К арендаторам можно обращаться как по отдельности, так и через несколько разделов, что делает этот подход хорошо подходящим для сценариев с агрегированными запросами или аналитикой по сегментам арендаторов. Кроме того, вы можете гибко загружать или освобождать данные для определенных арендаторов, чтобы эффективно управлять "горячими" и "холодными" данными.</p></li>
</ul>
<h3 id="Partition-key-level-multi-tenancy" class="common-anchor-header">Многопользовательская аренда на уровне ключа раздела</h3><p>При этой стратегии все арендаторы используют единую коллекцию и схему, но данные каждого арендатора автоматически распределяются по 16 физически изолированным разделам на основе значения <a href="/docs/ru/use-partition-key.md">ключа раздела</a>. Хотя каждый физический раздел может содержать несколько арендаторов, данные разных арендаторов остаются логически разделенными.</p>
<p>
  
   <span class="img-wrapper"> <img translate="no" src="/docs/v2.5.x/assets/partition-key-level-multi-tenancy.png" alt="Partition Key Level Multi Tenancy" class="doc-image" id="partition-key-level-multi-tenancy" />
   </span> <span class="img-wrapper"> <span>Уровень ключа раздела Много арендаторов</span> </span></p>
<ul>
<li><p><strong>Масштабируемость</strong>: Стратегия на уровне ключа раздела предлагает наиболее масштабируемый подход, поддерживающий миллионы арендаторов.</p></li>
<li><p><strong>Изоляция данных</strong>: Эта стратегия обеспечивает относительно слабую изоляцию данных, поскольку несколько арендаторов могут совместно использовать физический раздел.</p></li>
<li><p><strong>Гибкость</strong>: Поскольку все арендаторы должны использовать одну и ту же схему данных, эта стратегия обеспечивает ограниченную гибкость данных.</p></li>
<li><p><strong>Другие</strong>: RBAC не поддерживается на уровне ключей разделов. К арендаторам можно обращаться как по отдельности, так и через несколько разделов, что делает этот подход хорошо подходящим для сценариев с агрегированными запросами или аналитикой по сегментам арендаторов.</p></li>
</ul>
<h2 id="Choosing-the-right-multi-tenancy-strategy" class="common-anchor-header">Выбор правильной стратегии многопользовательской аренды<button data-href="#Choosing-the-right-multi-tenancy-strategy" class="anchor-icon" translate="no">
      <svg translate="no"
        aria-hidden="true"
        focusable="false"
        height="20"
        version="1.1"
        viewBox="0 0 16 16"
        width="16"
      >
        <path
          fill="#0092E4"
          fill-rule="evenodd"
          d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"
        ></path>
      </svg>
    </button></h2><p>В таблице ниже представлено комплексное сравнение между четырьмя уровнями стратегий многопользовательской эксплуатации.</p>
<table>
   <tr>
     <th></th>
     <th><p><strong>Уровень базы данных</strong></p></th>
     <th><p><strong>Уровень коллекции</strong></p></th>
     <th><p><strong>Уровень разделов</strong></p></th>
     <th><p><strong>Уровень ключей разделов</strong></p></th>
   </tr>
   <tr>
     <td><p><strong>Изоляция данных</strong></p></td>
     <td><p>Физическая</p></td>
     <td><p>Физическая</p></td>
     <td><p>Физический</p></td>
     <td><p>Физический + логический</p></td>
   </tr>
   <tr>
     <td><p><strong>Максимальное количество арендаторов</strong></p></td>
     <td><p>По умолчанию 64. Вы можете увеличить его, изменив параметр <code translate="no">maxDatabaseNum</code> в конфигурационном файле Milvus.yaml. </p></td>
     <td><p>По умолчанию 65 536. Вы можете увеличить его, изменив параметр <code translate="no">maxCollectionNum</code> в конфигурационном файле Milvus.yaml.</p></td>
     <td><p>До 1 024 на коллекцию. </p></td>
     <td><p>Миллионы</p></td>
   </tr>
   <tr>
     <td><p><strong>Гибкость схемы данных</strong></p></td>
     <td><p>Высокая</p></td>
     <td><p>Средняя</p></td>
     <td><p>Низкая</p></td>
     <td><p>Низкий</p></td>
   </tr>
   <tr>
     <td><p><strong>Поддержка RBAC</strong></p></td>
     <td><p>Да</p></td>
     <td><p>Да</p></td>
     <td><p>Нет</p></td>
     <td><p>Нет</p></td>
   </tr>
   <tr>
     <td><p><strong>Производительность поиска</strong></p></td>
     <td><p>Сильный</p></td>
     <td><p>Сильная</p></td>
     <td><p>Средняя</p></td>
     <td><p>Средняя</p></td>
   </tr>
   <tr>
     <td><p><strong>Поддержка межарендного поиска</strong></p></td>
     <td><p>Нет</p></td>
     <td><p>Нет</p></td>
     <td><p>Да</p></td>
     <td><p>Да</p></td>
   </tr>
   <tr>
     <td><p><strong>Поддержка эффективной работы с "горячими" и "холодными" данными</strong></p></td>
     <td><p>Да</p></td>
     <td><p>Да</p></td>
     <td><p>Да</p></td>
     <td><p>Нет В настоящее время стратегия на уровне ключей разделов не поддерживается.</p></td>
   </tr>
</table>
<p>При выборе стратегии многопользовательской работы в Milvus необходимо учитывать несколько факторов.</p>
<ol>
<li><p><strong>Масштабируемость:</strong> Ключ раздела &gt; раздел &gt; коллекция &gt; база данных</p>
<p>Если вы планируете поддерживать очень большое количество арендаторов (миллионы и более), используйте стратегию на уровне ключа раздела.</p></li>
<li><p><strong>Сильные требования к изоляции данных</strong>: База данных = Коллекция &gt; Раздел &gt; Ключ раздела</p>
<p>Выбирайте стратегии на уровне базы данных, коллекции или раздела, если у вас строгие требования к физической изоляции данных.</p></li>
<li><p><strong>Гибкая схема данных для данных каждого арендатора:</strong> База данных &gt; Коллекция &gt; Раздел = Ключ раздела</p>
<p>Стратегии на уровне базы данных и на уровне коллекции обеспечивают полную гибкость схем данных. Если структуры данных ваших арендаторов отличаются, выбирайте многопользовательский режим на уровне базы данных или на уровне коллекции.</p></li>
<li><p><strong>Другие</strong></p>
<ol>
<li><p><strong>Производительность:</strong> Производительность поиска определяется различными факторами, включая индексы, параметры поиска и конфигурацию машины. Milvus также поддерживает настройку производительности. Рекомендуется протестировать фактическую производительность перед выбором стратегии многопользовательской работы.</p></li>
<li><p><strong>Эффективная обработка "горячих" и "холодных" данных</strong>: В настоящее время стратегии на уровне баз данных, коллекций и разделов поддерживают работу с "горячими" и "холодными" данными.</p></li>
<li><p><strong>Поиск между арендаторами</strong>: Только стратегии на уровне разделов и разделов-ключей поддерживают межпользовательские запросы.</p></li>
</ol></li>
</ol>
