---
id: chunk_cache.md
title: Настройка кэш-памяти
---
<h1 id="Configure-Chunk-Cache" class="common-anchor-header">Настройка кэш-памяти<button data-href="#Configure-Chunk-Cache" class="anchor-icon" translate="no">
      <svg translate="no"
        aria-hidden="true"
        focusable="false"
        height="20"
        version="1.1"
        viewBox="0 0 16 16"
        width="16"
      >
        <path
          fill="#0092E4"
          fill-rule="evenodd"
          d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"
        ></path>
      </svg>
    </button></h1><p>Механизм chunk cache позволяет Milvus предварительно загружать данные в кэш на локальном жестком диске узлов запроса до того, как они понадобятся. Этот механизм значительно повышает производительность поиска векторов за счет сокращения времени, необходимого для загрузки данных с диска в память.</p>
<h2 id="Background" class="common-anchor-header">Справочная информация<button data-href="#Background" class="anchor-icon" translate="no">
      <svg translate="no"
        aria-hidden="true"
        focusable="false"
        height="20"
        version="1.1"
        viewBox="0 0 16 16"
        width="16"
      >
        <path
          fill="#0092E4"
          fill-rule="evenodd"
          d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"
        ></path>
      </svg>
    </button></h2><p>Перед выполнением запросов для получения векторов Milvus необходимо загрузить данные из объектного хранилища в кэш-память на локальном жестком диске узлов запроса. Этот процесс занимает много времени. Пока все данные не загружены, Milvus может отвечать на некоторые запросы на получение векторов с задержкой.</p>
<p>Чтобы повысить производительность запросов, Milvus предоставляет механизм кэширования чанков для предварительной загрузки данных из объектного хранилища в кэш на локальном жестком диске до того, как они понадобятся. Когда поступает запрос, Segcore сначала проверяет, находятся ли данные в кэше, а не в объектном хранилище. Если данные находятся в кэше, Segcore может быстро извлечь их из кэша и вернуть результат клиенту.</p>
<h2 id="Configure-Chunk-Cache" class="common-anchor-header">Настройка кэша чанков<button data-href="#Configure-Chunk-Cache" class="anchor-icon" translate="no">
      <svg translate="no"
        aria-hidden="true"
        focusable="false"
        height="20"
        version="1.1"
        viewBox="0 0 16 16"
        width="16"
      >
        <path
          fill="#0092E4"
          fill-rule="evenodd"
          d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"
        ></path>
      </svg>
    </button></h2><p>В этом руководстве приведены инструкции по настройке механизма кэширования чанков для экземпляра Milvus. Конфигурация зависит от способа установки экземпляра Milvus.</p>
<ul>
<li><p>Для экземпляров Milvus, установленных с помощью Helm Charts</p>
<p>Добавьте конфигурацию в файл <code translate="no">values.yaml</code> в разделе <code translate="no">config</code>. Подробнее см. в разделе <a href="/docs/ru/configure-helm.md">Настройка Milvus с помощью Helm Charts</a>.</p></li>
<li><p>Для экземпляров Milvus, установленных с помощью Docker Compose</p>
<p>Добавьте конфигурацию в файл <code translate="no">milvus.yaml</code>, который вы использовали для запуска экземпляра Milvus. Подробнее см. в разделе <a href="/docs/ru/configure-docker.md">Настройка Milvus с помощью Docker Compose</a>.</p></li>
<li><p>Для экземпляров Milvus, установленных с помощью Operator</p>
<p>Добавьте конфигурацию в раздел <code translate="no">spec.components</code> пользовательского ресурса <code translate="no">Milvus</code>. Подробнее см. в разделе <a href="/docs/ru/configure_operator.md">Настройка Milvus с помощью Operator</a>.</p></li>
</ul>
<h3 id="Configuration-options" class="common-anchor-header">Параметры конфигурации</h3><pre><code translate="no" class="language-yaml"><span class="hljs-attr">queryNode</span>:
    <span class="hljs-attr">cache</span>:
        <span class="hljs-attr">warmup</span>: <span class="hljs-keyword">async</span>
<button class="copy-code-btn"></button></code></pre>
<p>Параметр <code translate="no">warmup</code> определяет, будет ли Milvus предварительно загружать данные из хранилища объектов в кэш на локальном жестком диске узлов запросов до того, как они понадобятся. По умолчанию этот параметр принимает значение <code translate="no">disable</code>. Возможные варианты следующие:</p>
<ul>
<li><code translate="no">async</code>: Milvus предварительно загружает данные асинхронно в фоновом режиме, что не влияет на время, необходимое для загрузки коллекции. Тем не менее, пользователи могут испытывать задержку при получении векторов в течение короткого периода времени после завершения процесса загрузки.  Эта опция используется по умолчанию.</li>
<li><code translate="no">sync</code>: Milvus предварительно загружает данные синхронно, что может повлиять на время загрузки коллекции. Однако пользователи могут выполнять запросы сразу после завершения процесса загрузки без какой-либо задержки.</li>
<li><code translate="no">disable</code>: Milvus не выполняет предварительную загрузку данных в кэш памяти.</li>
</ul>
<p>Обратите внимание, что настройки кэша чанков также применяются при вставке новых данных в коллекции или перестройке индексов коллекций.</p>
<h3 id="FAQ" class="common-anchor-header">ЧАСТО ЗАДАВАЕМЫЕ ВОПРОСЫ</h3><ul>
<li><p><strong>Как я могу определить, правильно ли работает механизм кэширования чанков?</strong></p>
<p>Рекомендуется проверить задержку запроса на поиск или запрос после загрузки коллекции. Если задержка значительно выше ожидаемой (например, несколько секунд), это может указывать на то, что механизм кэширования чанков все еще работает.</p>
<p>Если задержка запроса остается высокой в течение длительного времени. Вы можете проверить пропускную способность хранилища объектов, чтобы убедиться, что кэш чанков все еще работает. В нормальных случаях работающий кэш будет генерировать высокую пропускную способность объектного хранилища. В качестве альтернативы можно просто попробовать кэш чанков в режиме <code translate="no">sync</code>.</p></li>
</ul>
